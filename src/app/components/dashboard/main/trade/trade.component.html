<!-- Modal start -->
<!-- PlaceOrder -->
<div class="modal fade AccountModal PlaceOrderModal" id="PlaceOrder" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content PlaceOrderContent">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <h3>Place Order</h3>
      <!-- Modal Content Start -->
      <div class="PlaceOrderTabPannel">
        <ul class="nav nav-tabs PlaceOrderTab1" id="PlaceTab" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active" id="ProductList-tab" data-bs-toggle="tab" data-bs-target="#ProductList"
              type="button" role="tab" aria-controls="ProductList" aria-selected="true">Product List</button>
          </li>
          <li class="nav-item" role="presentation">
            <button (click)="switchToStrategyTab()"
              class="nav-link" id="PlaceOrderStrategy-tab" data-bs-target="#PlaceOrderStrategy"
              data-bs-toggle="modal" data-bs-dismiss="modal">Strategy Template</button>
          </li>
        </ul>
        <div class="tab-content PlaceOrderTabContent1" id="PlaceTabContent">
          <!-- Product List-->
          <div class="tab-pane fade show active ProductListContent" id="ProductList" role="tabpanel" aria-labelledby="ProductList-tab">
            <div class="ProductListContentTop">
              <div class="optionStockMain">
                <div class="SelectSymbol">
                  <label>Symbol</label>
                  <div class="selectpicker dash-select OptionSelect">
                    <ng-select
                    dropdownPosition="bottom"
                    (change)="onProductSelected($event)"
                    [items]="Products$ | async"
                    [trackByFn]="searchProductTrackByFn"
                    bindLabel="Symbol"
                    [loading]="ProductSearchLoading"
                    [(ngModel)]="SelectedProduct"
                    [ngModelOptions]="{standalone: true}"
                    placeholder="Type to Search"
                    [typeahead]="ProductInput$">
                    <ng-template ng-option-tmp let-item="item" let-index="index">
                      <div class="product-name">
                        {{item.ProductName}}
                      </div>
                      <div class="product-symbol">
                        <b>{{item.Symbol}}</b> [{{item.Currency}}]
                      </div>
                    </ng-template>
                  </ng-select>
                  </div>
                </div>
                <ul class="nav nav-tabs  PlaceOrderTab1" id="OptionStock" role="tablist">
                  <li class="nav-item" role="presentation">
                    <button [ngClass]="{'active' : currentProductListTab === 'product-list-option'}" (click)="switchToOptionTab()"
                      class="nav-link" id="Option-tab" data-bs-toggle="tab" data-bs-target="#Option" type="button" role="tab" aria-controls="Option" aria-selected="false">Option</button>
                  </li>
                  <li class="nav-item" role="presentation">
                    <button [ngClass]="{'active' : currentProductListTab === 'product-list-stock'}" (click)="switchToStockTab()"
                      class="nav-link" id="Stock-tab" data-bs-toggle="tab" data-bs-target="#Stock" type="button" role="tab" aria-controls="Stock" aria-selected="true">Stock</button>
                  </li>
                </ul>
              </div>
              <div *ngIf="!SelectedProduct" class="tab-content OptionStockContent" id="OptionStockContent">
                <!-- Option Content -->
                <div [ngClass]="{'active' : currentProductListTab === 'product-list-option'}"
                  class="tab-pane fade show" id="Option" role="tabpanel" aria-labelledby="Option-tab">
                  <div style="width: 1224px;height:646px;text-align:center;transform: translateY(25%);">Please select product by typing on Symbol field</div>
                </div>
                <div [ngClass]="{'active' : currentProductListTab === 'product-list-stock'}"
                  class="tab-pane fade StockContentMain" id="Stock" role="tabpanel" aria-labelledby="Stock-tab">
                  <div style="width: 648px;height:568px;text-align:center;transform: translateY(25%)">Please select product by typing on Symbol field</div>
                </div>
                <!-- Stock Content -->
              </div>
              <div *ngIf="SelectedProduct" class="tab-content OptionStockContent" id="OptionStockContent">
                <!-- Option Content -->
                <div [ngClass]="{'active' : currentProductListTab === 'product-list-option'}"
                  class="tab-pane fade show" id="Option" role="tabpanel" aria-labelledby="Option-tab">
                  <div class="OptionContentMain">
                    <!-- Option Left Pannel -->
                    <div class="OptionContentLft">
                      <div class="OptionContentLftTop">
                        <div class="OptionContentFilter1">
                          <form>
                            <div class="form-control">
                              <label>Type</label>
                              <select #typeSelect class="form-select selectDefault" (change)='onTypeChanged(typeSelect.value)'>
                                <option value="All" selected>All</option>
                                <option value="Call">Call</option>
                                <option value="Put">Put</option>
                              </select>
                            </div>
                            <div class="form-control">
                              <label>Expiry Date</label>
                              <select (ngModelChange)='onExpiryDateChanged($event)'
                                [(ngModel)]="SelectedOptionExpiryDate" [ngModelOptions]="{standalone: true}"
                                class="form-select selectDefault DateSelect" aria-label="">
                                <option *ngFor="let expiryDate of (OptionExpiryDates$ | async)?.ExpiryDates" [ngValue]="expiryDate">
                                  {{ expiryDate }}
                                </option>
                              </select>
                            </div>
                          </form>
                        </div>
                        <div class="OptionContentFilter2">
                          <a class="BtnDefault2" id="FiltertDropdown" data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false"> Filter <img src="//am708403.blob.core.windows.net/images/optionpi/img/filter2.png">
                          </a>
                          <ul class="dropdown-menu dropdownDefault FilterDrop  dropdown-menu-lg-end dropdown-menu-lg-start" aria-labelledby="FiltertDropdown">
                            <li>
                              <form [formGroup]="stockDataFilterForm" (ngSubmit)="filterStockData()">
                                <table>
                                  <tr>
                                    <td>
                                      <label>Volume</label>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Greater than</label>
                                        <input type="text" name="volume_grater_then" formControlName="volume_grater_then" />
                                      </div>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Less than</label>
                                        <input type="text" name="volume_less_then" formControlName="volume_less_then" />
                                      </div>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                      <label>Delta %</label>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Greater than</label>
                                        <input type="text" name="delta_grater_then" formControlName="delta_grater_then" />
                                      </div>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Less than</label>
                                        <input type="text" name="delta_less_then" formControlName="delta_less_then" />
                                      </div>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                      <label>Open Interest</label>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Greater than</label>
                                        <input type="text" name="open_interest_grater_then" formControlName="open_interest_grater_then" />
                                      </div>
                                    </td>
                                    <td>
                                      <div>
                                        <label>Less than</label>
                                        <input type="text" name="open_interest_less_then" formControlName="open_interest_less_then" />
                                      </div>
                                    </td>
                                  </tr>
                                </table>
                                <div class="d-flex justify-content-end">
                                  <button class="BtnDefault" type="submit" name="submit" style="margin-right: 10px;">Confirm</button>
                                </div>
                              </form>
                            </li>
                          </ul>
                          <a class="BtnDefault2" id="ColumnDropdown" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> Column <img src="//am708403.blob.core.windows.net/images/optionpi/img/column.png">
                          </a>
                          <ul class="dropdown-menu dropdownDefault ColumnDrop dropdown-menu-end" aria-labelledby="dropdownMenuClickableInside">
                            <li>
                              <form>
                                <div class="form-group checkbox" *ngFor="let placeOrderColumn of placeOrderColumns; let i = index">
                                  <input (click)="filterColumns(i)" type="checkbox" id={{placeOrderColumn.name}} name={{placeOrderColumn.name}} [ngModel]="placeOrderColumn.checked" ng-checked="placeOrderColumn.checked">
                                  <label for={{placeOrderColumn.name}}>{{placeOrderColumn.name}}</label>
                                </div>
                              </form>
                            </li>
                          </ul>

                          <div>
                            <div style="display: flex;">
                              <a (click)="reloadOptionData()" class="BtnSecondary ReloadButton">Reload <img
                                  src="//am708403.blob.core.windows.net/images/optionpi/img/reload.png"></a>
                            </div>
                          </div>

                        </div>
                      </div>
                      <div class="OptionContentLftBtm">
                        <app-loading [status]="isLoading"></app-loading>
                        <div class="d-flex flex-wrap fixedTable">
                          <div [ngClass]="OptionTable4Classes">
                            <aside class="fixedTable-sidebar table4" #table4ScrollElement
                              (scroll)="scrollTable4Handler($event)">
                              <table *ngIf="!isLoading" class="table selectTable text-center myTable4" id="myTable4"
                                [ngStyle]="dynamicStyleTable4">
                                <thead>
                                  <tr class="callHead">
                                    <th rowspan="2" class="NonClick">Strike Price</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let snapshoot of OptionSnapshotData">
                                    <td class="NonClick">{{snapshoot.StrikePrice}}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </aside>
                          </div>
                          <div [ngClass]="OptionTable1Classes">
                            <div class="fixedTable-body table1" #table1ScrollElement
                              (scroll)="scrollTable1Handler($event)">
                              <!-- <div class="table-responsive"> -->
                              <table *ngIf="!isLoading" class="table selectTable text-center myTable1" id="myTable1"
                                [ngStyle]="dynamicStyleTable1">
                                <thead>
                                  <tr class="callHead">
                                    <ng-container *ngFor="let callTableColumn of callTableColumns">
                                      <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn(callTableColumn.key)">{{callTableColumn.label}}</th>
                                    </ng-container>
                                  </tr>
                                  <tr class="callHead">
                                    <th colspan="6">Call</th>
                                  </tr>
                                </thead>
                                <tbody style="width: 100%; float: left;">
                                  <tr (click)="setSelectedPlaceOrderRowCall(snapshoot)"
                                    [ngClass]="{ 'Highlight' : snapshoot.Call.isSelected !== undefined && snapshoot.Call.isSelected, 'callBG': (snapshoot.StrikePrice < placeOrderLastTradedPrice) }"
                                    *ngFor="let snapshoot of OptionSnapshotData; let i = index;">
                                      <ng-container *ngFor="let callTableColumn of callTableColumns">
                                        <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn(callTableColumn.key)">{{checkValueByKey(snapshoot.Call, callTableColumn)}}</td>
                                      </ng-container>
                                  </tr>
                                </tbody>


                                <!-- <thead *ngIf="selectedType === 'Call'" style="display: none;" >
                                  <tr class="callHead">
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">Bid Vol.</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">Bid</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">Ask</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">Ask Vol.</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">Break Even %</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')">% Change</th>
                                  </tr>
                                  <tr class="callHead">
                                    <th colspan="6">Call</th>
                                  </tr>
                                </thead>
                                <thead *ngIf="selectedType === 'All'" style="display: none;">
                                  <tr class="callHead">
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')">% Change</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">Break Even %</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">Ask Vol. <i class="bi bi-arrow-down"></i></th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">Ask</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">Bid</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">Bid Vol.</th>
                                  </tr>
                                  <tr class="callHead">
                                    <th colspan="6">Call</th>
                                  </tr>
                                </thead>
                                <tbody style="width: 100%; float: left; display: none;" *ngIf="selectedType === 'Call'">
                                  <tr (click)="setSelectedPlaceOrderRowCall(snapshoot)"
                                    [ngClass]="{ 'Highlight' : snapshoot.Call.isSelected !== undefined && snapshoot.Call.isSelected, 'callBG': (snapshoot.StrikePrice < placeOrderLastTradedPrice) }"
                                    *ngFor="let snapshoot of OptionSnapshotData">
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">{{snapshoot.Call.BidVolume}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">{{snapshoot.Call.Bid}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">{{snapshoot.Call.Ask}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">{{snapshoot.Call.AskVolume}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">{{snapshoot.Call.BreakEvenPct | percent:'1.2-2'}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')"><span [ngClass]="{'red_number' : snapshoot.Call.PctChange < 0, 'green_number' : snapshoot.Call.PctChange > 0}">{{snapshoot.Call.PctChange | percent:'1.2-2'}}</span></td>
                                  </tr>
                                </tbody>
                                <tbody style="width: 100%; float: left; display: none" *ngIf="selectedType === 'All'" >
                                  <tr (click)="setSelectedPlaceOrderRowCall(snapshoot)"
                                    [ngClass]="{ 'Highlight' : snapshoot.Call.isSelected !== undefined && snapshoot.Call.isSelected, 'callBG': (snapshoot.StrikePrice < placeOrderLastTradedPrice) }"
                                    *ngFor="let snapshoot of OptionSnapshotData">
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')"><span [ngClass]="{'red_number' : snapshoot.Call.PctChange < 0, 'green_number' : snapshoot.Call.PctChange > 0}">{{snapshoot.Call.PctChange | percent:'1.2-2'}}</span></td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">{{snapshoot.Call.BreakEvenPct | percent:'1.2-2'}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">{{snapshoot.Call.AskVolume}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">{{snapshoot.Call.Ask}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">{{snapshoot.Call.Bid}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">{{snapshoot.Call.BidVolume}}</td>
                                  </tr>
                                </tbody> -->
                              </table>
                              <!-- </div> -->
                            </div>
                          </div>
                          <div [ngClass]="OptionTable2Classes">
                            <aside class="fixedTable-sidebar table2" #table2ScrollElement
                              (scroll)="scrollTable2Handler($event)">
                              <!-- <div class="table-responsive w-auto overflow-x"> -->
                              <table *ngIf="!isLoading" class="table selectTable text-center myTable2" id="myTable2"
                                [ngStyle]="dynamicStyleTable2">
                                <thead>
                                  <tr class="callHead">
                                    <th rowspan="2" class="NonClick">Strike Price</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr
                                    [ngClass]="{ 'Highlight' : (snapshoot.Call.isSelected !== undefined && snapshoot.Call.isSelected || snapshoot.Put.isSelected !== undefined && snapshoot.Put.isSelected) }"
                                    *ngFor="let snapshoot of OptionSnapshotData">
                                    <td class="NonClick">{{snapshoot.StrikePrice}}</td>
                                  </tr>
                                </tbody>
                              </table>
                              <!-- </div> -->
                            </aside>
                          </div>
                          <div [ngClass]="OptionTable3Classes">
                            <div class="fixedTable-body table3" #table3ScrollElement
                              (scroll)="scrollTable3Handler($event)">
                              <!-- <div class="table-responsive"> -->
                              <table *ngIf="!isLoading" class="table selectTable text-center myTable3" id="myTable3"
                                [ngStyle]="dynamicStyleTable3">

                                <thead>
                                  <tr class="putHead">
                                    <ng-container *ngFor="let putTableColumn of putTableColumns">
                                      <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn(putTableColumn.key)">{{putTableColumn.label}}</th>
                                    </ng-container>
                                  </tr>
                                  <tr class="putHead">
                                    <th colspan="6">Put</th>
                                  </tr>
                                </thead>
                                <tbody style="width: 100%; float: left;">
                                  <tr (click)="setSelectedPlaceOrderRowPut(snapshoot)"
                                    [ngClass]="{ 'Highlight' : snapshoot.Put.isSelected !== undefined && snapshoot.Put.isSelected, 'putBG': (snapshoot.StrikePrice > placeOrderLastTradedPrice) }"
                                    *ngFor="let snapshoot of OptionSnapshotData; let i = index;">
                                      <ng-container *ngFor="let putTableColumn of putTableColumns">
                                        <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn(putTableColumn.key)">{{checkValueByKey(snapshoot.Put, putTableColumn)}}</td>
                                      </ng-container>
                                  </tr>
                                </tbody>

                                <!-- <thead style="display: none;">
                                  <tr class="putHead">
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">Bid Vol.</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">Bid</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">Ask</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">Ask Vol.</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">Break Even %</th>
                                    <th *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')">% Change</th>
                                  </tr>
                                  <tr class="putHead">
                                    <th colspan="6">Put</th>
                                  </tr>
                                </thead>
                                <tbody style="width: 100%; float: left; display: none;">
                                  <tr (click)="setSelectedPlaceOrderRowPut(snapshoot)"
                                    [ngClass]="{ 'Highlight' : snapshoot.Put.isSelected !== undefined && snapshoot.Put.isSelected, 'putBG': (snapshoot.StrikePrice > placeOrderLastTradedPrice) }"
                                    *ngFor="let snapshoot of OptionSnapshotData">
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BidVolume')">{{snapshoot.Put.BidVolume}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Bid')">{{snapshoot.Put.Bid}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('Ask')">{{snapshoot.Put.Ask}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('AskVolume')">{{snapshoot.Put.AskVolume}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('BreakEvenPct')">{{snapshoot.Put.BreakEvenPct | percent:'1.2-2'}}</td>
                                    <td *ngIf="placeOrderColumns.length > 0 && getStatusByColumn('PctChange')"><span [ngClass]="{'red_number' : snapshoot.Put.PctChange < 0, 'green_number' : snapshoot.Put.PctChange > 0}">{{snapshoot.Put.PctChange | percent:'1.2-2'}}</span></td>
                                  </tr>
                                </tbody> -->
                              </table>
                              <!-- </div> -->
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- Option Right Pannel -->
                    <div class="OptionContentRgt">
                      <form class="OptForm" [formGroup]="OptionOrderForm" (ngSubmit)="submitOptionOrder()">
                        <div class="form-control">
                          <label>Action</label>
                          <select formControlName="SelectedOptionAction" class="form-select" aria-label="Default select example">
                            <option value="Buy" selected="">Buy</option>
                            <option value="Sell">Sell</option>
                          </select>
                        </div>
                        <div class="form-control">
                          <label>Contract</label>
                          <input [(ngModel)]="SelectedOptionContract" [ngModelOptions]="{standalone: true}" type="text" name="product" placeholder="">
                          <!-- <ng-select
                            dropdownPosition="bottom"
                            (change)="onOptionContractSelected($event)"
                            [items]="OptionContracts$ | async"
                            [trackByFn]="searchOptionContractTrackByFn"
                            bindLabel="Symbol"
                            [loading]="OptionContractSearchLoading"
                            [(ngModel)]="SelectedOptionContract"
                            [ngModelOptions]="{standalone: true}"
                            placeholder="Choose Option Contract"
                            [typeahead]="OptionContractInput$">
                            <ng-template ng-option-tmp let-item="item" let-index="index">
                              <div class="product-name">
                                {{item.ProductName}}
                              </div>
                              <div class="product-symbol">
                                <b>{{item.Symbol}}</b> [{{item.Currency}}]
                              </div>
                            </ng-template>
                          </ng-select> -->
                          <a *ngIf="SelectedOptionContract"
                            class="BtnDefault ComputeButton" data-bs-target="#Calculator" data-bs-toggle="modal"
                                data-bs-dismiss="modal" (click)="loadCalculatorModal()">Analyze<img
                                  src="//am708403.blob.core.windows.net/images/optionpi/img/beaker.png"></a>
                        </div>
                        <div class="form-control">
                          <label>Quantity</label>
                          <div>
                            <input formControlName="OptionQuantity" type="text" name="quantity" value="1">
                            <label>Lot</label>
                          </div>
                        </div>
                        <div class="form-control">
                          <label>Type: Limit</label>
                        </div>
                        <div class="form-control">
                          <label>Limit Price</label>
                          <div>
                            <input formControlName="OptionLimitPrice" type="text" name="price">
                            <a (click)="decreaseOptionLimitPrice()"  class="DangerBg">
                              <i class="bi bi-arrow-down-circle"></i>
                            </a>
                            <a (click)="increaseOptionLimitPrice()"  class="SuccessBg">
                              <i class="bi bi-arrow-up-circle"></i>
                            </a>
                          </div>
                        </div>
                        <div class="form-control">
                          <label>Validity: Day</label>
                        </div>
                        <div class="form-control">
                          <label>Account</label>
                          <div>
                            <select formControlName="SelectedAccount" class="form-select selectDefault" aria-label="Account" style="width: 100%;">
                              <option *ngFor="let brokerAccount of AvailableBrokerAccounts" [ngValue]="brokerAccount">
                                {{ brokerAccount.id }} ({{brokerAccount.brokerType}})
                              </option>
                            </select>
                          </div>
                        </div>
                        <button class="BtnDefault w-100" type="submit" name="submit" data-bs-toggle="modal" data-bs-target="#ConfirmOptionOrder" data-bs-toggle="modal" data-bs-dismiss="modal"> Submit </button>
                      </form>
                    </div>
                  </div>
                </div>
                <!-- Stock Content -->
                <div [ngClass]="{'active' : currentProductListTab === 'product-list-stock'}"
                  class="tab-pane fade show StockContentMain" id="Stock" role="tabpanel" aria-labelledby="Stock-tab">
                  <div class="StockContentMainTop">
                    <ul>
                      <li>
                        <div>
                          <p>Last</p>
                          <h2>{{(StockData$ | async)?.LastTradedPrice | number}}</h2>
                        </div>
                        <div>
                          <p>Today Volume</p>
                          <h2>{{(StockData$ | async)?.CumulativeVolume | number}}</h2>
                        </div>
                      </li>
                      <li>
                        <div class="DangerBg">
                          <div>
                            <p>Bid Vol</p>
                            <p>Bid</p>
                          </div>
                        </div>
                        <div class="SuccessBg">
                          <div>
                            <p>Ask</p>
                            <p>Ask Vol</p>
                          </div>
                        </div>
                      </li>
                      <li>
                        <div>
                          <div>
                            <p>{{(StockData$ | async)?.BidSize | number}}</p>
                            <p>{{(StockData$ | async)?.BidPrice | number}}</p>
                          </div>
                        </div>
                        <div>
                          <div>
                            <p>{{(StockData$ | async)?.AskSize | number}}</p>
                            <p>{{(StockData$ | async)?.AskPrice | number}}</p>
                          </div>
                        </div>
                      </li>
                    </ul>
                  </div>
                  <div class="StockContentMainBtm">
                    <form class="OptForm" [formGroup]="StockOrderForm" (ngSubmit)="submitStockOrder()">
                      <div class="form-control">
                        <label>Action</label>
                        <select (change)='onStockActionChanged(StockOrderForm.value.SelectedStockAction)'
                          formControlName="SelectedStockAction" class="form-select" aria-label="Default select example">
                          <option value="Buy" selected="">Buy</option>
                          <option value="Sell">Sell</option>
                        </select>
                      </div>
                      <div class="form-control">
                        <label>Quantity</label>
                        <div>
                          <input formControlName="StockQuantity" type="text" name="quantity" placeholder="1">
                          <select formControlName="SelectedStockUnitType" class="form-select w-50" aria-label="Default select example">
                            <option *ngFor="let unitType of StockUnitTypeList" [ngValue]="unitType">
                              {{ unitType.Display }}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="form-control">
                        <label>Type</label>
                        <select formControlName="SelectedStockOrderType" class="form-select" aria-label="Default select example">
                          <option *ngFor="let orderType of StockOrderTypeList" [ngValue]="orderType">
                            {{ orderType.Display }}
                          </option>
                        </select>
                        {{StockOrderForm.value.orderType}}
                      </div>
                      <div class="form-control" *ngIf="StockOrderForm.value.SelectedStockOrderType.Name === 'Limit'">
                        <label>Limit Price</label>
                        <div>
                          <input formControlName="StockLimitPrice" type="text" name="price">
                          <a (click)="decreaseStockLimitPrice()" class="DangerBg">
                            <i class="bi bi-arrow-down-circle"></i>
                          </a>
                          <a (click)="increaseStockLimitPrice()"class="SuccessBg">
                            <i class="bi bi-arrow-up-circle"></i>
                          </a>
                        </div>
                      </div>
                      <div class="form-control" *ngIf="StockOrderForm.value.SelectedStockOrderType.Name === 'Stop'">
                        <label>Stop Price</label>
                        <div>
                          <input formControlName="StockStopPrice" type="text" name="price">
                          <a (click)="decreaseStockStopPrice()" class="DangerBg">
                            <i class="bi bi-arrow-down-circle"></i>
                          </a>
                          <a (click)="increaseStockStopPrice()" class="SuccessBg">
                            <i class="bi bi-arrow-up-circle"></i>
                          </a>
                        </div>
                      </div>
                      <div class="form-control" *ngIf="StockOrderForm.value.SelectedStockOrderType.Name === 'Market'">
                      </div>
                      <div class="form-control">
                        <label>Validity</label>
                        <div class="radioDefault">
                          <label>
                            <input formControlName="SelectedStockValidity" type="radio" value="GTC" /> GTC </label>
                          <label>
                            <input formControlName="SelectedStockValidity" type="radio" value="Day" checked /> Day </label>
                        </div>
                      </div>
                      <div class="form-control">&nbsp;</div>
                      <div style="width: 100%; float: left; border-top: 1px solid #d3d3d3; height: 0; margin-bottom: 10px;">&nbsp;</div>
                      <div class="form-control">
                        <label style="width: 25%; float: left; margin-top: 10px;">Account</label>
                        <select formControlName="SelectedAccount" class="form-select selectDefault" aria-label="Account" style="width: 75%; float: left;">
                          <option *ngFor="let brokerAccount of AvailableBrokerAccounts" [ngValue]="brokerAccount">
                            {{ brokerAccount.id }} ({{brokerAccount.brokerType}})
                          </option>
                        </select>
                      </div>
                      <div class="form-control">
                        <button type="submit" name="submit" class="BtnDefault w-100" data-bs-toggle="modal"
                          data-bs-target="#ConfirmStockOrder" data-bs-toggle="modal" data-bs-dismiss="modal" style="margin-top: 2px;"> Submit
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Strategy Template -->
          <!-- <div class="tab-pane fade" id="Strategy" role="tabpanel" aria-labelledby="Strategy-tab">...</div> -->
        </div>
      </div>
      <!-- Modal Content End -->
    </div>
  </div>
</div>

<!-- Place Order Strategy Templete -->
<div class="modal fade AccountModal PlaceOrderModal" id="PlaceOrderStrategy" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false"  tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
     <div class="modal-content PlaceOrderContent">
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        <h3>Place Order</h3>
        <!-- Modal Content Start -->
        <div class="PlaceOrderTabPannel StrategyMain">
           <div class="StrategyLft">
             <div class="StrategyLftTop">
              <ul class="nav nav-tabs PlaceOrderTab1" id="PlaceTab" role="tablist">
                 <li class="nav-item" role="presentation">
                    <button (click)="switchToProductListTab()"
                      class="nav-link" role="button" data-bs-target="#PlaceOrder" data-bs-toggle="modal"
                      data-bs-dismiss="modal">Product List</button>
                 </li>
                 <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="Strategy-tab" data-bs-toggle="tab" data-bs-target="#Strategy"
                    type="button" role="tab" aria-controls="Strategy" aria-selected="false">Strategy Template</button>
                 </li>
              </ul>
            </div>
             <div class="StrategyLftBtm">
               <form class="w-100 SideBarForm" [formGroup]="ByStrategyForm">
                   <div class="form-control w-100">
                      <label>Strategy</label>
                      <select (change)='onPlaceOrderStrategyChanged(ByStrategyForm.value.SelectedStrategy)'
                        formControlName="SelectedStrategy" class="form-select selectDefault w-100" aria-label="" >
                        <option selected="" [ngValue]="undefined">Choose Strategy</option>
                        <option *ngFor="let strategy of PlaceOrderStrategyList" [ngValue]="strategy">
                          {{ strategy.Display }}
                        </option>
                      </select>
                   </div>
                   <div class="form-control w-100">
                      <label>Stock</label>
                      <!-- <input formControlName="SelectedStock" type="text" name="stock" placeholder="Choose Stock" class="w-100"> -->
                      <ng-select
                        dropdownPosition="bottom"
                        (change)="onStrategyProductSelected($event)"
                        [items]="Products$ | async"
                        [trackByFn]="searchProductTrackByFn"
                        bindLabel="Symbol"
                        [loading]="ProductSearchLoading"
                        [(ngModel)]="SelectedProduct"
                        [ngModelOptions]="{standalone: true}"
                        placeholder="Choose Stock"
                        [typeahead]="ProductInput$">
                        <ng-template ng-option-tmp let-item="item" let-index="index">
                          <div>
                            {{item.ProductName}}
                          </div>
                          <div>
                            <b>{{item.Symbol}}</b> [{{item.Currency}}]
                          </div>
                        </ng-template>
                      </ng-select>
                   </div>
                   <div *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'Straddle' && ByStrategyForm.value.SelectedStrategy?.Name !== 'DeltaNeutral' && ByStrategyForm.value.SelectedStrategy?.Name !== 'CalendarPutSpread' && ByStrategyForm.value.SelectedStrategy?.Name !== 'CalendarCallSpread'"
                    class="form-control w-100">
                    <label>Expiry</label>
                    <select formControlName="SelectedExpiry" class="form-select selectDefault w-100" aria-label="">
                      <option *ngFor="let parameter of ExpiryParameterList" [ngValue]="parameter">
                        {{ parameter.Name }}
                      </option>
                    </select>
                   </div>
                   <div class="form-control w-100">
                      <label>Parameters</label>
                      <select formControlName="SelectedParameter" class="form-select selectDefault w-100" aria-label="">
                        <option *ngFor="let parameter of OptionParameterList" [ngValue]="parameter">
                          {{ parameter.Display }}
                        </option>
                      </select>
                   </div>
                   <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'CustomSetup'">
                    <label>Strike Price Distance from ATM (%)</label>
                    <input type="text" name="stock" placeholder="Choose Stock" class="w-100" value="0">
                  </div>
                  <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'CustomSetup'">
                    <label>Expiry Distance Between Contracts</label>
                    <select formControlName="SelectedCalendarSpreadExpiry" class="form-select selectDefault w-100" aria-label="">
                      <option *ngFor="let parameter of CalendarSpreadExpiryParameterList" [ngValue]="parameter">
                        {{ parameter.Name }}
                      </option>
                    </select>
                  </div>
                  <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'BrokenWingButterflyLegDistance'">
                    <label>Lower Leg (from ATM)</label>
                    <ngx-slider formControlName="ButterflyLowerLeg" [options]="ButterflyLegOptions"></ngx-slider>
                    <div class="rangeData">
                      <span>-100</span>
                      <span>100</span>
                    </div>
                  </div>
                  <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'BrokenWingButterflyLegDistance'">
                    <label>Middle Leg (from ATM)</label>
                    <ngx-slider formControlName="ButterflyMiddleLeg" [options]="ButterflyLegOptions"></ngx-slider>
                    <div class="rangeData">
                      <span>-100</span>
                      <span>100</span>
                    </div>
                  </div>
                  <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'BrokenWingButterflyLegDistance'">
                    <label>Upper Leg (from ATM)</label>
                    <ngx-slider formControlName="ButterflyUpperLeg" [options]="ButterflyLegOptions"></ngx-slider>
                    <div class="rangeData">
                      <span>-100</span>
                      <span>100</span>
                    </div>
                  </div>
                   <div class="form-control w-100" *ngIf="ByStrategyForm.value.SelectedParameter.Name === 'Probability'">
                     <label>Probability</label>
                     <input class="range-example-input" type="text" min="0" max="100" value="10" name="points" step="0.01" />
                     <div class="rangeData">
                       <span>0</span>
                       <span>10</span>
                     </div>
                   </div>
                   <a class="BtnDefault w-100">Search</a>
               </form>
             </div>
           </div>
           <div class="StrategyRgt" *ngIf="ByStrategyForm.value.SelectedStrategy && SelectedProduct">
             <div class="StrategyRgtTop">
               <p><strong>{{ByStrategyForm.value.SelectedStrategy.Display}} # {{SelectedProduct?.Symbol}},</strong> Underlying Price = {{(StockData$ | async)?.LastTradedPrice | currency:'USD'}}</p>
             </div>
             <div class="StrategyRgtBtm">
               <form class="w-100 SideBarForm" [formGroup]="ByStrategyForm" (ngSubmit)="submitStrategyOrder()">
                 <div class="StrategyForm">
                   <div class="form-control">
                     <label>Amount</label>
                     <input formControlName="Amount" type="text" name="amount">
                   </div>
                   <div class="form-control">
                     <label>Type</label>
                     <div>
                      Limit
                     </div>
                     <!-- <select class="form-select selectDefault w-100" aria-label="">
                       <option selected="">Limit</option>
                       <option value="1">Limit</option>
                     </select> -->
                   </div>
                   <div class="form-control">
                     <label>Validity</label>
                     <div>Day</div>
                     <!-- <div class="radioDefault">
                       <label>
                         <input type="radio" name="radio" />
                         GTC
                       </label>
                       <label>
                         <input type="radio" name="radio" checked />
                         Day
                       </label>
                     </div> -->
                   </div>
                   <div class="form-control">
                    <label>&nbsp;</label>
                    <div style="display: flex; margin-top: -4px;">
                      <a (click)="reloadStrategyData()" class="BtnSecondary ReloadButton">Reload <img
                          src="//am708403.blob.core.windows.net/images/optionpi/img/reload.png"></a>&nbsp;&nbsp;
                      <a (click)="loadStrategyCalculatorModal()" class="BtnDefault ComputeButton" data-bs-target="#Calculator" data-bs-toggle="modal"
                        data-bs-dismiss="modal">Analyze <img
                          src="//am708403.blob.core.windows.net/images/optionpi/img/beaker.png"></a>
                    </div>
                  </div>
                 </div>
                 <div class="StrategyTable">
                   <div *ngIf="isLoadingStrategyContractResult" class="StrategyContractLoading">                  
                    Loading Contracts... <app-loading [status]="isLoadingStrategyContractResult"></app-loading>                                
                   </div>
                   <div *ngIf="!isLoadingStrategyContractResult" class="table-responsive">
                     <table class="table table-striped" formArrayName="Legs">
                       <tbody>
                         <tr class="HighlightTableStripted">
                           <td colspan="6">Option Contract</td>
                         </tr>
                         <tr>
                           <th>Action</th>
                           <th>Option</th>
                           <th>Qty</th>
                           <th>SP</th>
                           <th>Expiry</th>
                           <!-- <th>Price</th> -->
                           <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                           <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">Fair Value</th>
                         </tr>
                         <ng-container *ngFor="let Leg of ByStrategyForm.value.Legs;let i = index;">
                          <tr *ngIf="Leg">
                            <ng-container [formGroupName]="i">
                              <td>
                                <p>{{Leg.Direction}}</p>
                              </td>
                              <td>{{Leg.Rights}}</td>
                              <td>{{Leg.Quantity}}</td>
                              <td>{{Leg.StrikePrice}}</td>
                              <td>{{Leg.Expiry}}</td>
                              <!-- <td><input class="place-order-strategy-input" type="text" name="LimitPrice"
                                  value="{{Leg.LimitPrice}}" formControlName="LimitPrice"></td> -->
                              <td *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></td>
                              <td *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">{{Leg.FairValue}}</td>
                            </ng-container>
                          </tr>
                        </ng-container>
                       </tbody>
                     </table>
                     <table class="table table-striped" *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'DeltaNeutral'">
                      <tbody>
                        <tr class="HighlightTableStripted">
                          <td colspan="6">Stock</td>
                        </tr>
                        <tr>
                          <th>Action</th>
                          <th></th>
                          <th>Qty</th>
                          <th></th>
                          <th></th>
                          <!-- <th></th> -->
                          <th>Price</th>
                        </tr>
                        <tr>
                          <td>{{ByStrategyForm.value.Direction}}</td>
                          <td></td>
                          <td>{{ByStrategyForm.value.Quantity}}</td>
                          <td></td>
                          <td></td>
                          <!-- <td></td> -->
                          <td>{{ByStrategyForm.value.LimitPrice}}</td>
                          <!-- <td><input class="place-order-strategy-input" type="text" name="price"
                            value="{{ByStrategyForm.value.LimitPrice}}" formControlName="LimitPrice"></td> -->
                        </tr>
                      </tbody>
                    </table>
                   </div>
                 </div>
                 <div class="w-100 SubmitBlock">
                  <div *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'" class="w-25" 
                  style="float: left;text-align: left;display: flex;">
                  <label style="margin-top: 12px;">Bundle Price: {{getIronCondorBundlePrice()}}</label>
                  </div>
                  <div class="w-100" style="float: right;text-align: right;display: flex;">
                    <label style="margin-top: 12px;margin-right: 20px;">Account</label>
                      <select formControlName="SelectedAccount" class="form-select selectDefault" aria-label="Account" style="margin-right: 20px;float: right;width: 100%;">
                        <option *ngFor="let brokerAccount of AvailableBrokerAccounts" [ngValue]="brokerAccount">
                          {{ brokerAccount.id }} ({{brokerAccount.brokerType}})
                        </option>
                      </select>
                    </div>
                    <button class="BtnDefault" type="submit" data-bs-target="#StrategyConfrimOrder" data-bs-toggle="modal"
                      data-bs-dismiss="modal">Submit <i class="bi bi-cart3"></i></button>
                  </div>
               </form>
             </div>
           </div>
           <!-- <div class="StrategyRgt EmptyParameter">
              <div class="PayoffLftBtm h-100">
                 <div class="configure">
                    <img src="//am708403.blob.core.windows.net/images/optionpi/img/settings.png">
                    <h2>Please configure the parameter </h2>
                    <p>Please configure the parameter and select the value to show the graph</p>
                 </div>
              </div>
           </div> -->
        </div>
        <!-- Modal Content End -->
     </div>
  </div>
</div>
<!-- Calculator Modal-->
<div class="modal fade AccountModal PlaceOrderModal CalculatorModal" id="Calculator" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content PlaceOrderContent">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <form [formGroup]="CalculatorFormGroup">
        <h3>Calculator</h3>
        <div class="CalculatorTop" *ngIf="CalculatorFormGroup.value.Strategy">
          <div>
            <ul>
              <li>
                <span>Symbol</span>
                <p>{{CalculatorFormGroup.value.Symbol}}</p>
              </li>
              <li>
                <span>Strategy</span>
                <p>{{CalculatorFormGroup.value.Strategy}}</p>
              </li>
            </ul>
          </div>
          <div>
            <ul>
              <li>
                <span>Max Profit</span>
                <p>{{ CalculatorFormGroup.value.Strategy == "Straddle"? "undefined" :
                  "$"+(MaxProfitLoss$|async)?.MaxProfit}}</p>

              </li>
              <li>
                <span>Max Loss</span>
                <p>${{(MaxProfitLoss$|async)?.MaxLoss}}</p>
              </li>
            </ul>
          </div>
        </div>
        <div class="CalculatorBtm">
          <div class="CalculatorLft" formGroupName="CurrentState">
            <h3>Current State</h3>
            <ul>
              <li *ngFor="let leg of CalculatorFormGroup.value.CurrentState.Legs">
                <span>Leg {{leg.LegId}} - Implied Volatility</span>
                <p>{{leg.IV | percent:'1.2-2'}}</p>
              </li>
              <li>
                <span>Stock Price</span>
                <p>{{CalculatorFormGroup.value.CurrentState.StockPrice | currency:'USD'}}</p>
              </li>
              <li>
                <span>ATM Mean IV</span>
                <p>{{CalculatorFormGroup.value.CurrentState.ATMMeanIV | percent:'1.2-2'}}</p>
              </li>
              <li>
                <span>Dividend Yield</span>
                <p>{{CalculatorFormGroup.value.CurrentState.DividendYield | percent:'1.2-2'}}</p>
              </li>
              <li>
                <span>Interest Rate</span>
                <p>{{CalculatorFormGroup.value.CurrentState.InterestRate | percent:'1.2-2'}}</p>
              </li>
              <li>
                <span>Mean Skew</span>
                <p>{{CalculatorFormGroup.value.CurrentState.MeanSkew}}</p>
              </li>
              <li>
                <span>Days To Expiry</span>
                <p>{{CalculatorFormGroup.value.CurrentState.DaysToExpiry}}</p>
              </li>
            </ul>
            <div class="BackBtn">
              <a *ngIf="currentTradeTab === 'by-product'" class="BtnDefault w-100" data-bs-target="#PlaceOrder" data-bs-toggle="modal"
                data-bs-dismiss="modal">Back</a>
              <a *ngIf="currentTradeTab === 'by-strategy'" class="BtnDefault w-100" data-bs-target="#PlaceOrderStrategy" data-bs-toggle="modal"
              data-bs-dismiss="modal">Back</a>
            </div>
          </div>
          <div class="CalculatorRgt" formGroupName="NextState">
            <h3>Next State</h3>
            <div class="CalculatorMidl">
              <table>
                <tr>
                  <td>ATM Mean IV</td>
                  <td>
                    <input value="{{ CalculatorFormGroup.value.NextState.ATMMeanIV}}" name="atmMeanIV"
                      class="place-order-strategy-input" formControlName="ATMMeanIV" contenteditable>%
                  </td>
                </tr>
                <tr>
                  <td>Stock Price</td>
                  <td>
                    <input value="{{ CalculatorFormGroup.value.NextState.StockPrice}}" name="stockPrice"
                      class="place-order-strategy-input" formControlName="StockPrice" contenteditable>
                  </td>
                </tr>
                <tr>
                  <td>Days to Expiry</td>
                  <td>
                    <input value="{{CalculatorFormGroup.value.NextState.Period}}" class="place-order-strategy-input"
                      formControlName="Period" value="0" name="period" contenteditable> days
                  </td>
                </tr>
              </table>
            </div>
            <div class="ComputeBtn">
              <a class="BtnDefault w-100" (click)="computeProfitLoss()">Compute <img
                  src="//am708403.blob.core.windows.net/images/optionpi/img/beaker.png"></a>
            </div>
            <ul>
              <li>
                <span>Profit/Loss</span>
              </li>
              <li>
                <p [ngClass]="ProfitLossResult > 0 ? 'SuccessTxt' : 'DangerTxt'">${{ProfitLossResult}}</p>
              </li>
            </ul>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- Strategy Confrim Order -->
<div class="modal fade AccountModal PlaceOrderModal StrategyConfrimOrderModal" id="StrategyConfrimOrder"
  aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content PlaceOrderContent">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <h3>This order will be created</h3>
      <!-- Modal Content Start -->
      <div class="PlaceOrderTabPannel StrategyMain">
        <div class="StrategyRgt">
          <div class="StrategyRgtTop">
            <p><strong>{{ConfirmedStrategyOrder.strategy}} # {{ConfirmedStrategyOrder.symbol}},</strong> Underlying
              Price = {{(StockData$ | async)?.LastTradedPrice | number}}</p>
            <p>Account: <strong>{{ConfirmedStrategyOrder.account}} ({{ConfirmedStrategyOrder.broker}})</strong></p>
          </div>
          <div class="StrategyRgtBtm">
            <form class="w-100 SideBarForm">
              <div class="StrategyTable">
                <div class="table-responsive">
                  <table class="table table-striped">
                    <tbody>
                      <tr class="HighlightTableStripted">
                        <td colspan="6">Option Contract</td>
                      </tr>
                      <tr>
                        <th>Action</th>
                        <th>Option</th>
                        <th>Qty</th>
                        <th>SP</th>
                        <th>Expiry</th>
                        <!-- <th>Price</th> -->
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">Fair Value</th>
                      </tr>
                      <tr *ngIf="ConfirmedStrategyOrder.legs[0]">
                        <td>
                          <p>{{ConfirmedStrategyOrder.legs[0].Direction}}</p>
                        </td>
                        <td>{{ConfirmedStrategyOrder.legs[0].Rights}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[0].Quantity}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[0].StrikePrice}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[0].Expiry}}</td>
                        <!-- <td>{{ConfirmedStrategyOrder.legs[0].LimitPrice}}</td> -->
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">{{ConfirmedStrategyOrder.legs[0].FairValue}}</th>
                      </tr>
                      <tr *ngIf="ConfirmedStrategyOrder.legs[1]">
                        <td>
                          <p>{{ConfirmedStrategyOrder.legs[1].Direction}}</p>
                        </td>
                        <td>{{ConfirmedStrategyOrder.legs[1].Rights}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[1].Quantity}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[1].StrikePrice}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[1].Expiry}}</td>
                        <!-- <td>{{ConfirmedStrategyOrder.legs[1].LimitPrice}}</td> -->
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">{{ConfirmedStrategyOrder.legs[1].FairValue}}</th>
                      </tr>
                      <tr *ngIf="ConfirmedStrategyOrder.legs[2]">
                        <td>
                          <p>{{ConfirmedStrategyOrder.legs[2].Direction}}</p>
                        </td>
                        <td>{{ConfirmedStrategyOrder.legs[2].Rights}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[2].Quantity}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[2].StrikePrice}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[2].Expiry}}</td>
                        <!-- <td>{{ConfirmedStrategyOrder.legs[2].LimitPrice}}</td> -->
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">{{ConfirmedStrategyOrder.legs[2].FairValue}}</th>
                      </tr>
                      <tr *ngIf="ConfirmedStrategyOrder.legs[3]">
                        <td>
                          <p>{{ConfirmedStrategyOrder.legs[3].Direction}}</p>
                        </td>
                        <td>{{ConfirmedStrategyOrder.legs[3].Rights}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[3].Quantity}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[3].StrikePrice}}</td>
                        <td>{{ConfirmedStrategyOrder.legs[3].Expiry}}</td>
                        <!-- <td>{{ConfirmedStrategyOrder.legs[3].LimitPrice}}</td> -->
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'"></th>
                        <th *ngIf="ByStrategyForm.value.SelectedStrategy?.Name !== 'IronCondor'">{{ConfirmedStrategyOrder.legs[3].FairValue}}</th>
                      </tr>
                    </tbody>
                    <tbody *ngIf="ConfirmedStrategyOrder.strategy === 'DeltaNeutral'">
                      <tr class="HighlightTableStripted">
                        <td colspan="6">Stock</td>
                      </tr>
                      <tr>
                        <th>Action</th>
                        <th></th>
                        <th>Qty</th>
                        <th></th>
                        <th></th>
                        <!-- <th></th> -->
                        <th>Price</th>
                      </tr>
                      <tr>
                        <td>{{ConfirmedStrategyOrder.direction}}</td>
                        <td></td>
                        <td>{{ConfirmedStrategyOrder.quantity}}</td>
                        <td></td>
                        <td></td>
                        <!-- <td></td> -->
                        <td>{{ConfirmedStrategyOrder.limitPrice}}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="w-100 SubmitBlock">
        <div *ngIf="ByStrategyForm.value.SelectedStrategy?.Name === 'IronCondor'" class="w-25" 
          style="float: left;text-align: left;display: flex;">
          <label style="margin-top: 12px;">Bundle Price: {{getIronCondorBundlePrice()}}</label>
        </div>
        <a class="BtnSecondary" data-bs-target="#PlaceOrderStrategy" data-bs-toggle="modal" data-bs-dismiss="modal"><i
            class="bi bi-arrow-left"></i> Previous</a>
        <a class="BtnDefault" data-bs-target="#OrderSuccess" data-bs-toggle="modal" data-bs-dismiss="modal"
          (click)="confirmSendStrategyOrder()">Submit <i class="bi bi-cart3"></i></a>
      </div>
      <!-- Modal Content End -->
    </div>
  </div>
</div>
<!-- Strategy Success Order -->
<div class="modal fade AccountModal OrderCreatedModal StrategyOrderSuccess" id="OrderSuccess" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>Order Created! </h4>
        <div>
          <img src="//am708403.blob.core.windows.net/images/optionpi/img/checked.png">
          <p class="PriceLine">
            <strong>{{StrategyOrderSuccessParameter.Strategy}} # {{StrategyOrderSuccessParameter.Underlying}},</strong> Underlying Price = {{(StockData$ | async)?.LastTradedPrice | currency:'USD'}}
          </p>
          <p>Your order has been successfully placed</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="BtnDefault w-100" (click)="seeMyOrders()">See My Order </button>
      </div>
    </div>
  </div>
</div>
<!-- Strategy Order Rejected #StrategyOrderRejected-->
<div class="modal fade AccountModal OrderRejectModal StrategyOrderRejectedModal" id="StrategyOrderRejected" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>Order rejected!</h4>
        <div>
          <img src="//am708403.blob.core.windows.net/images/optionpi/img/cancel.png">
          <p class="PriceLine">
            <strong>{{StrategyOrderRejectedParameter.Strategy}} # {{StrategyOrderRejectedParameter.Underlying}},</strong> Underlying Price = {{(StockData$ | async)?.LastTradedPrice | currency:'USD'}}
          </p>
          <p>Your order has been rejected for following reason:
            <span class="text-alert">{{StrategyOrderRejectedParameter.RejectReason}}</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Confirm Order -->
<div class="modal fade AccountModal ConfirmOrderModal" id="ConfirmStockOrder" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>This stock order will be created:</h4>
        <table>
          <tr>
            <th>Action</th>
            <td>
              <span class="textHighlight">{{ConfirmedStockOrder.action}}</span>
            </td>
          </tr>
          <tr>
            <th>Account</th>
            <td>{{ConfirmedStockOrder.account}} ({{ConfirmedStockOrder.broker}})</td>
          </tr>
          <tr>
            <th>Product</th>
            <td>{{ConfirmedStockOrder.product.ProductName}} ({{ConfirmedStockOrder.product.Symbol}})</td>
          </tr>
          <tr>
            <th>Quantity</th>
            <td>{{ConfirmedStockOrder.quantity}} {{ConfirmedStockOrder.unitType}}</td>
          </tr>
          <tr>
            <th>Order Type</th>
            <td>{{ConfirmedStockOrder.orderType}}</td>
          </tr>
          <tr *ngIf="ConfirmedStockOrder.orderType === 'Limit'">
            <th>Limit Price</th>
            <td>US$ {{ConfirmedStockOrder.limitPrice}}</td>
          </tr>
          <tr *ngIf="ConfirmedStockOrder.orderType === 'Stop'">
            <th>Stop Price</th>
            <td>US$ {{ConfirmedStockOrder.stopPrice}}</td>
          </tr>
          <tr>
            <th>Validity</th>
            <td>{{ConfirmedStockOrder.validity}}</td>
          </tr>
        </table>
      </div>
      <div class="modal-footer">
        <button class="BtnSecondary" data-bs-target="#PlaceOrder" data-bs-toggle="modal" data-bs-dismiss="modal">
          <i class="bi bi-arrow-left"></i> Previous </button>
        <button class="BtnDefault" (click)="confirmSendStockOrder()" data-bs-toggle="modal" data-bs-dismiss="modal">Submit <i class="bi bi-cart"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Confirm Order -->
<div class="modal fade AccountModal ConfirmOrderModal" id="ConfirmOptionOrder" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>This option order will be created:</h4>
        <table>
          <tr>
            <th>Action</th>
            <td>
              <span class="textHighlight">{{ConfirmedOptionOrder.action}}</span>
            </td>
          </tr>
          <tr>
            <th>Account</th>
            <td>{{ConfirmedOptionOrder.account}} ({{ConfirmedOptionOrder.broker}})</td>
          </tr>
          <tr>
            <th>Product</th>
            <td>{{ConfirmedOptionOrder.product}}</td>
          </tr>
          <tr>
            <th>Quantity</th>
            <td>{{ConfirmedOptionOrder.quantity}} {{ConfirmedOptionOrder.unitType}}</td>
          </tr>
          <tr>
            <th>Order Type</th>
            <td>{{ConfirmedOptionOrder.orderType}}</td>
          </tr>
          <tr>
            <th>Limit Price</th>
            <td>US$ {{ConfirmedOptionOrder.limitPrice}}</td>
          </tr>
          <tr>
            <th>Validity</th>
            <td>{{ConfirmedOptionOrder.validity}}</td>
          </tr>
        </table>
      </div>
      <div class="modal-footer">
        <button class="BtnSecondary" data-bs-target="#PlaceOrder" data-bs-toggle="modal" data-bs-dismiss="modal">
          <i class="bi bi-arrow-left"></i> Previous </button>
        <button class="BtnDefault" (click)="confirmSendOptionOrder()" data-bs-toggle="modal" data-bs-dismiss="modal">Submit
          <i class="bi bi-cart"></i>
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Order Created -->
<div class="modal fade AccountModal OrderCreatedModal" id="OrderCreated" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>Order Created! </h4>
        <div>
          <img src="//am708403.blob.core.windows.net/images/optionpi/img/checked.png">
          <h5>{{OrderSuccessParameter.Action}} {{OrderSuccessParameter.Quantity}} {{OrderSuccessParameter.Symbol}}
            <span *ngIf="OrderSuccessParameter.OrderType === 'Limit'">@ {{OrderSuccessParameter.LimitPrice}}</span>
            <span *ngIf="OrderSuccessParameter.OrderType === 'Stop'">@ {{OrderSuccessParameter.StopPrice}}</span>
          </h5>
          <p>Your order has been successfully placed</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="BtnDefault w-100" (click)="seeMyOrders()">See My Order </button>
      </div>
    </div>
  </div>
</div>
<!-- Order Rejected -->
<div class="modal fade AccountModal OrderRejectModal" id="OrderRejected" aria-hidden="true" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      <div class="modal-body">
        <h4>Order rejected!</h4>
        <div>
          <img src="//am708403.blob.core.windows.net/images/optionpi/img/cancel.png">
          <h5>{{OrderRejectedParameter.Action}} {{OrderRejectedParameter.Quantity}} {{OrderRejectedParameter.Symbol}}
            <span *ngIf="OrderRejectedParameter.OrderType === 'Limit'">@ {{OrderRejectedParameter.LimitPrice}}</span>
            <span *ngIf="OrderRejectedParameter.OrderType === 'Stop'">@ {{OrderRejectedParameter.StopPrice}}</span>
          </h5>
          <p>Your order has been rejected for following reason:
            <span class="text-alert">{{OrderRejectedParameter.RejectReason}}</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Modal Ends -->

<div class="tab-pane fade show active" id="Trade" role="tabpanel" aria-labelledby="Trade-tab">
  <div class="TradeHead">
    <h3>Filter</h3>
  </div>
  <!-- Trade Filter Bar -->
  <div class="TradeFilterBar OptionContentLftTop">
    <div class="OptionContentFilter1">
      <form>
        <div class="form-control">
          <label>Broker</label>
          <select (ngModelChange)='onBrokerTypeChanged($event)'
          [(ngModel)]="SelectedBroker" [ngModelOptions]="{standalone: true}" class="form-select selectDefault" aria-label="Default select example" id="SelectType">
            <option *ngFor="let brokerType of brokerTypes" [ngValue]="brokerType">
              {{ brokerType.name }}
            </option>
          </select>
        </div>
        <div class="form-control">
          <label>Account</label>
          <select (ngModelChange)='onAccountChanged($event)'
          [(ngModel)]="SelectedBrokerAccount" [ngModelOptions]="{standalone: true}" class="form-select selectDefault" aria-label="Default select example">
            <option *ngFor="let brokerAccount of brokerAccounts" [ngValue]="brokerAccount">
              {{ brokerAccount.id }}
            </option>
          </select>
        </div>
      </form>
    </div>
    <div class="OptionContentFilter2">
      <a class="BtnSecondary" data-bs-toggle="modal" href="#LiquidateAllModal">Liquidate All <img src="//am708403.blob.core.windows.net/images/optionpi/img/cash.png"></a>
      <a class="BtnDefault" data-bs-toggle="modal" (click)="preselectAccount()" href="#PlaceOrder">Place Order <i class="bi bi-cart3"></i></a>
    </div>
  </div>
  <!-- Liquidate All Confirmation -->
  <div class="modal fade AccountModal ConfirmOrderModal" id="LiquidateAllModal" aria-hidden="true" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="modal-body">
          <h4>Liquidate All</h4>
          <div>
            Are you sure you want to liquidate all current positions?
          </div>
          <div>
            Please double check your current positions as this action cannot be undone
          </div>
        </div>
        <div class="modal-footer">
          <button class="BtnDefault" (click)="confirmLiquidateAll()" data-bs-toggle="modal"
            data-bs-dismiss="modal">Liquidate All</button>
          <button class="BtnSecondary" data-bs-toggle="modal"
            data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Trade Account Tab -->
  <div class="TradeAccountTabMain">
    <ul class="nav nav-tabs DashboardTab" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button [ngClass]="{'active' : currentTab === 'account-summary'}" class="nav-link" id="AccountSummary-tab"
          type="button" (click)="setTab('account-summary')" aria-selected="true">Account Summary</button>
      </li>
      <li class="nav-item" role="presentation">
        <button [ngClass]="{'active' : currentTab === 'active-position'}" class="nav-link" type="button"
          (click)="setTab('active-position')" aria-selected="true">Active Positions</button>
      </li>
      <li class="nav-item" role="presentation">
        <button [ngClass]="{'active' : currentTab === 'active-orders'}" class="nav-link" type="button"
          (click)="setTab('active-orders')" aria-selected="true">Active Orders</button>
      </li>
      <li class="nav-item" role="presentation">
        <button [ngClass]="{'active' : currentTab === 'historical-transactions'}" class="nav-link" type="button"
          (click)="setTab('historical-transactions')" aria-selected="true">Historical Transactions</button>
      </li>
    </ul>
    <div class="tab-content DashboardTabContent TradTabContent" id="myTabContent">
      <!-- Account Summary -->
      <div *ngIf="currentTab === 'account-summary'">
        <ow-main-trade-accountsummary-tab [SelectedBrokerAccount]="SelectedBrokerAccount"></ow-main-trade-accountsummary-tab>
      </div>
      <!-- Active Positions -->
      <div *ngIf="currentTab === 'active-position'">
        <ow-main-trade-activepositions-tab [SelectedBrokerAccount]="SelectedBrokerAccount"></ow-main-trade-activepositions-tab>
      </div>
      <!-- Active Orders -->
      <div *ngIf="currentTab === 'active-orders'">
        <ow-main-trade-activeorders-tab [SelectedBrokerAccount]="SelectedBrokerAccount"></ow-main-trade-activeorders-tab>
      </div>
      <!-- <div class="tab-pane fade" id="ActiveOrder" role="tabpanel" aria-labelledby="ActiveOrder-tab">...</div> -->
      <!-- Historical Transactions -->
      <div *ngIf="currentTab === 'historical-transactions'">
        <ow-main-trade-historicaltransactions-tab [SelectedBrokerAccount]="SelectedBrokerAccount"></ow-main-trade-historicaltransactions-tab>
      </div>
      <!-- <div class="tab-pane fade" id="HistoricalTransaction" role="tabpanel" aria-labelledby="HistoricalTransaction-tab">...</div> -->
    </div>
  </div>
</div>
