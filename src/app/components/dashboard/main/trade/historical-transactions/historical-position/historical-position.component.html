<div class="tab-pane HistoricalPositionTab show active " role="tabpanel" aria-labelledby="HistoricalPosition-tab">
  <div class="ActivePositionFilterBar">
    <form>
      <div class="form-control">
        <div class="FilterBarsearch">
          <input (keydown.enter)="search()" [(ngModel)]='SearchValue' type="text"
          class="form-control" placeholder="Search" aria-label="" aria-describedby="basic-addon1" [ngModelOptions]="{standalone: true}">
          <a class="FilterBarSearchIcon">
            <i class="fa fa-magnifying-glass" (click)="searchHistoricalPosition()" aria-hidden="true"></i>
          </a>
        </div>
      </div>
    </form>
  </div>
  <div class="ActivePositionTable ActiveOrderTable">
    <div class="table-responsive" style="min-height: 100px;">
      <app-loading [status]="isLoadingHistoricalPosition"></app-loading>
      <table *ngIf="!isLoadingHistoricalPosition" class="table">
        <thead>
          <tr>
            <th class="text-center">Leg</th>
            <th (click)="sortColumns('PortfolioName', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Symbol
              <a *ngIf="currentSortedColumn.name === 'PortfolioName'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Desc', 'fa-arrow-down' : currentSortedColumn.type === 'Asc'}"></i>
              </a>
            </th>
            <th class="OnClickDiplay" (click)="sortColumns('Position', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Pos
              <a *ngIf="currentSortedColumn.name === 'Position'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th class="text-center" (click)="sortColumns('Quantity', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Qty
              <a *ngIf="currentSortedColumn.name === 'Quantity'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th class="text-center" (click)="sortColumns('Entry', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Entry
              <a *ngIf="currentSortedColumn.name === 'Entry'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th class="text-center" (click)="sortColumns('Exit', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Exit
              <a *ngIf="currentSortedColumn.name === 'Exit'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('RealizedPL', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">RPL
              <a *ngIf="currentSortedColumn.name === 'RealizedPL'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('NetPL', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Net PL
              <a *ngIf="currentSortedColumn.name === 'NetPL'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('ContractType', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Type
              <a *ngIf="currentSortedColumn.name === 'ContractType'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('Expiry', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Expiry
              <a *ngIf="currentSortedColumn.name === 'Expiry'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('StrikePrice', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Strike
              <a *ngIf="currentSortedColumn.name === 'StrikePrice'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('Multiplier', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Multiplier
              <a *ngIf="currentSortedColumn.name === 'Multiplier'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('MaxEntryTime', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Entry Time
              <a *ngIf="currentSortedColumn.name === 'MaxEntryTime'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
            <th (click)="sortColumns('MaxExitTime', currentSortedColumn.type === 'Desc' ? 'Asc' : 'Desc')">Exit Time
              <a *ngIf="currentSortedColumn.name === 'MaxExitTime'">
                <i class="fa" [ngClass]="{'fa-arrow-up' : currentSortedColumn.type === 'Asc', 'fa-arrow-down' : currentSortedColumn.type === 'Desc'}"></i>
              </a>
            </th>
          </tr>
          <!-- <tr *ngIf="!isCollapsed">
            <th class="text-center">Leg</th>
            <th>Symbol
              <a>
                <i class="fa fa-arrow-down" aria-hidden="true"></i>
              </a>
            </th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th>RPL</th>
            <th>Net PL</th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
          </tr> -->
        </thead>
        <tbody *ngIf="!isLoadingHistoricalPosition && HistoricalPositionResult.TotalData === 0">
          <tr>
            <td style="text-align: center;" colspan="15">There is currently no entries available</td>
          </tr>
        </tbody>
        <tbody *ngIf="!isLoadingHistoricalPosition && HistoricalPositionResult.TotalData > 0">
          <ng-container *ngFor="let item of HistoricalPositionResult?.Data">
          <tr class="OnClickAdd">
            <td class="AddPlus">
              <a (click)="toggleCollapsedHistoricalPosition(item)"><span class="Plus" [ngClass]="{'added' : item.isCollapsed}"></span></a>
            </td>
            <td>
              <h4>{{item.PortfolioName}} </h4>
            </td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td>
              <span [ngClass]="{'red_number' : item.AggregatedRealizedPL < 0, 'green_number' : item.AggregatedRealizedPL > 0}">{{item.AggregatedRealizedPL | currency:'USD'}}</span>
            </td>
            <td>
              <span [ngClass]="{'red_number' : item.AggregatedNetPL < 0, 'green_number' : item.AggregatedNetPL > 0}">{{item.AggregatedNetPL | currency:'USD'}}</span>
            </td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
            <td class="OnClickDiplay"></td>
          </tr>
          <tr class="sub-data" [ngClass]="{'showhide' : !item.isCollapsed}">
            <!-- Number -->
            <td class="text-center">
              <table>
                <tr *ngIf="item.Leg1||item.Leg2||item.Leg3||item.Leg4">
                  <td>1</td>
                </tr>
                <tr *ngIf="item.Leg2||item.Leg3||item.Leg4">
                  <td>2</td>
                </tr>
                <tr *ngIf="item.Leg3||item.Leg4">
                  <td>3</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>4</td>
                </tr>
              </table>
            </td>
            <!-- Symbol -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Symbol}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Symbol}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Symbol}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Symbol}}</td>
                </tr>
              </table>
            </td>
            <!-- Position -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Position}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Position}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Position}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Position}}</td>
                </tr>
              </table>
            </td>
            <!-- Quantity -->
            <td class="text-center">
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Quantity}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Quantity}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Quantity}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Quantity}}</td>
                </tr>
              </table>
            </td>
            <!-- Entry -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Entry | currency:item.Leg1.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Entry | currency:item.Leg2.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Entry | currency:item.Leg3.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Entry | currency:item.Leg4.Currency}}</td>
                </tr>
              </table>
            </td>
            <!-- Exit -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Exit | currency:item.Leg1.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Exit | currency:item.Leg2.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Exit | currency:item.Leg3.Currency}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Exit | currency:item.Leg4.Currency}}</td>
                </tr>
              </table>
            </td>
            <!-- RealizedPL -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>
                    <span [ngClass]="{'red_number' : item.Leg1.RealizedPL < 0, 'green_number' : item.Leg1.RealizedPL > 0}">{{item.Leg1.RealizedPL | currency:item.Leg1.Currency}}</span>
                    <span [ngClass]="{'red_number' : item.Leg1.RealizedPLPct < 0, 'green_number' : item.Leg1.RealizedPLPct > 0}">({{item.Leg1.RealizedPLPct | percent:'1.2-2'}})</span>
                  </td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>
                    <span [ngClass]="{'red_number' : item.Leg2.RealizedPL < 0, 'green_number' : item.Leg2.RealizedPL > 0}">{{item.Leg2.RealizedPL | currency:item.Leg2.Currency}}</span>
                    <span [ngClass]="{'red_number' : item.Leg2.RealizedPLPct < 0, 'green_number' : item.Leg2.RealizedPLPct > 0}">({{item.Leg2.RealizedPLPct | percent:'1.2-2'}})</span>
                  </td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>
                    <span [ngClass]="{'red_number' : item.Leg3.RealizedPL < 0, 'green_number' : item.Leg3.RealizedPL > 0}">{{item.Leg3.RealizedPL | currency:item.Leg3.Currency}}</span>
                    <span [ngClass]="{'red_number' : item.Leg3.RealizedPLPct < 0, 'green_number' : item.Leg3.RealizedPLPct > 0}">({{item.Leg3.RealizedPLPct | percent:'1.2-2'}})</span>
                  </td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>
                    <span [ngClass]="{'red_number' : item.Leg4.RealizedPL < 0, 'green_number' : item.Leg4.RealizedPL > 0}">{{item.Leg4.RealizedPL | currency:item.Leg4.Currency}}</span>
                    <span [ngClass]="{'red_number' : item.Leg4.RealizedPLPct < 0, 'green_number' : item.Leg4.RealizedPLPct > 0}">({{item.Leg4.RealizedPLPct | percent:'1.2-2'}})</span>
                  </td>
                </tr>
              </table>
            </td>
            <!-- NetPL -->
            <td>
              <table>
                  <tr *ngIf="item.Leg1">
                      <td>
                        <span [ngClass]="{'red_number' : item.Leg1.NetPL < 0, 'green_number' : item.Leg1.NetPL > 0}">{{item.Leg1.NetPL | currency:item.Leg1.Currency}}</span>
                        <span [ngClass]="{'red_number' : item.Leg1.NetPLPct < 0, 'green_number' : item.Leg1.NetPLPct > 0}">({{item.Leg1.NetPLPct | percent:'1.2-2'}})</span>
                      </td>
                    </tr>
                    <tr *ngIf="item.Leg2">
                      <td>
                        <span [ngClass]="{'red_number' : item.Leg2.NetPL < 0, 'green_number' : item.Leg2.NetPL > 0}">{{item.Leg2.NetPL | currency:item.Leg2.Currency}}</span>
                        <span [ngClass]="{'red_number' : item.Leg2.NetPLPct < 0, 'green_number' : item.Leg2.NetPLPct > 0}">({{item.Leg2.NetPLPct | percent:'1.2-2'}})</span>
                      </td>
                    </tr>
                    <tr *ngIf="item.Leg3">
                      <td>
                        <span [ngClass]="{'red_number' : item.Leg3.NetPL < 0, 'green_number' : item.Leg3.NetPL > 0}">{{item.Leg3.NetPL | currency:item.Leg3.Currency}}</span>
                        <span [ngClass]="{'red_number' : item.Leg3.NetPLPct < 0, 'green_number' : item.Leg3.NetPLPct > 0}">({{item.Leg3.NetPLPct | percent:'1.2-2'}})</span>
                      </td>
                    </tr>
                    <tr *ngIf="item.Leg4">
                      <td>
                        <span [ngClass]="{'red_number' : item.Leg4.NetPL < 0, 'green_number' : item.Leg4.NetPL > 0}">{{item.Leg4.NetPL | currency:item.Leg4.Currency}}</span>
                        <span [ngClass]="{'red_number' : item.Leg4.NetPLPct < 0, 'green_number' : item.Leg4.NetPLPct > 0}">({{item.Leg4.NetPLPct | percent:'1.2-2'}})</span>
                      </td>
                    </tr>
              </table>
            </td>
            <!-- ContractType -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.ContractType}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.ContractType}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.ContractType}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.ContractType}}</td>
                </tr>
              </table>
            </td>
            <!-- Expiry -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Expiry | optionExpiryDate}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Expiry | optionExpiryDate}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Expiry | optionExpiryDate}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Expiry | optionExpiryDate}}</td>
                </tr>
              </table>
            </td>
            <!-- StrikePrice -->
            <td>
              <table>
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.StrikePrice}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.StrikePrice}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.StrikePrice}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.StrikePrice}}</td>
                </tr>
              </table>
            </td>
            <!-- Multiplier -->
            <td>
              <table class="white-break">
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.Multiplier}}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.Multiplier}}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.Multiplier}}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.Multiplier}}</td>
                </tr>
              </table>
            </td>
            <!-- EntryTime -->
            <td>
              <table class="white-break">
                <tr *ngIf="item.Leg1">
                  <td>{{item.Leg1.EntryTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                </tr>
                <tr *ngIf="item.Leg2">
                  <td>{{item.Leg2.EntryTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                </tr>
                <tr *ngIf="item.Leg3">
                  <td>{{item.Leg3.EntryTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                </tr>
                <tr *ngIf="item.Leg4">
                  <td>{{item.Leg4.EntryTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                </tr>
              </table>
            </td>
            <!-- ExitTime -->
            <td>
                <table class="white-break">
                  <tr *ngIf="item.Leg1">
                    <td>{{item.Leg1.ExitTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                  </tr>
                  <tr *ngIf="item.Leg2">
                    <td>{{item.Leg2.ExitTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                  </tr>
                  <tr *ngIf="item.Leg3">
                    <td>{{item.Leg3.ExitTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                  </tr>
                  <tr *ngIf="item.Leg4">
                    <td>{{item.Leg4.ExitTime | date: 'dd MMM yyyy, hh:mm:ss a' }}</td>
                  </tr>
                </table>
              </td>
          </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
    <nav aria-label="..." class="ScreenerPagination">
        <ul class="pagination" *ngIf="HistoricalPositionResult.TotalData > 0">
          <li class="page-item" [ngClass]="{disabled: IsFirstPage}">
            <a class="page-link" (click)="previousPage()">
              <i class="fa fa-arrow-left"></i>
              <span>Previous</span>
            </a>
          </li>
          <li>
            <ul>
              <li *ngFor="let pageNum of Pages" class="page-item" [ngClass]="{active: CurrentPage===pageNum}">
                <span class="page-link" (click)="goToPage(pageNum)">{{pageNum}}</span>
              </li>
            </ul>
            <span class="mobPagination">Page {{CurrentPage}} of {{TotalPage}}</span>
          </li>
          <li class="page-item" [ngClass]="{disabled: IsLastPage}">
            <a class="page-link" (click)="nextPage()">
              <span>Next</span>
              <i class="fa fa-arrow-right"></i>
            </a>
          </li>
        </ul>
      </nav>
  </div>
</div>